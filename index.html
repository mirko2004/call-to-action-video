<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Call To Action Video</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding-top: 20px; /* Aggiunto per dare spazio sopra il primo video */
            padding-bottom: 20px; /* Aggiunto per dare spazio sotto l'ultimo video */
        }

        .video-container {
            position: relative;
            width: 80%;
            max-width: 800px; /* Aumentato per video più grandi se necessario */
            margin-bottom: 30px; /* Aumentato spazio tra i video */
            background-color: #000;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Aggiunta una leggera ombra */
        }

        video {
            width: 100%;
            display: block;
            height: auto;
        }

        .overlay-play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 50px; /* Leggermente ridotto per bilanciare */
            color: white;
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 50%;
            padding: 18px; /* Leggermente ridotto */
            cursor: pointer;
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px; /* Coerente con font-size e padding */
            height: 50px; /* Coerente con font-size e padding */
            box-sizing: content-box;
            transition: background-color 0.2s ease;
        }

        .overlay-play-button:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        .custom-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.75);
            color: white;
            display: flex;
            align-items: center;
            padding: 8px 12px; /* Aumentato padding verticale */
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            z-index: 10;
            box-sizing: border-box;
        }

        .video-container:hover .custom-controls,
        .video-container .custom-controls.visible {
            opacity: 1;
        }

        .custom-controls button {
            background: none;
            border: none;
            color: white;
            font-size: 16px; /* Leggermente ridotto per compattezza */
            cursor: pointer;
            padding: 6px; /* Leggermente aumentato */
            margin-right: 6px;
            line-height: 1; /* Per allineamento verticale icone */
        }
        .custom-controls button:hover {
            color: #ddd;
        }
        .custom-controls button i {
            display: block; /* Aiuta con l'allineamento verticale in alcuni casi */
        }


        .progress-bar-container { /* Nuovo contenitore per la progress bar */
            flex-grow: 1;
            margin: 0 10px;
            display: flex; /* Default per essere visibile */
        }
        
        input[type="range"].progress-bar {
            flex-grow: 1; /* La barra occupa lo spazio disponibile */
            cursor: pointer;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            outline: none;
            margin: auto 0; /* Centra verticalmente */
        }

        input[type="range"].progress-bar::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            background: #ff0000; /* Rosso brillante */
            cursor: pointer;
            border-radius: 50%;
            margin-top: -3px; /* Allineamento verticale del thumb */
        }
        input[type="range"].progress-bar::-moz-range-thumb {
            width: 14px;
            height: 14px;
            background: #ff0000;
            cursor: pointer;
            border-radius: 50%;
            border: none;
        }

        .volume-container {
            display: flex;
            align-items: center;
            margin-right: 10px;
        }

        input[type="range"].volume-slider {
            width: 60px; /* Leggermente ridotto */
            margin-left: 6px;
            cursor: pointer;
            height: 6px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            margin: auto 0; /* Centra verticalmente */
        }
        input[type="range"].volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: white;
            cursor: pointer;
            border-radius: 50%;
            margin-top: -3px; /* Allineamento thumb */
        }
        input[type="range"].volume-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: white;
            cursor: pointer;
            border-radius: 50%;
            border: none;
        }

        .time-container {
            font-size: 12px;
            margin-right: 10px;
            min-width: 75px; /* Spazio per "0:00 / 0:00" */
            text-align: center;
            display: flex; /* Default per essere visibile */
            align-items: center; /* Centra verticalmente il testo */
        }

        /* Nascondere progressBar e time-container in fullscreen */
        .video-container:-webkit-full-screen .progress-bar-container,
        .video-container:-moz-full-screen .progress-bar-container,
        .video-container:fullscreen .progress-bar-container,
        .video-container:-webkit-full-screen .time-container,
        .video-container:-moz-full-screen .time-container,
        .video-container:fullscreen .time-container {
            display: none !important;
        }

        /* Tentativo di nascondere controlli nativi che potrebbero apparire su iOS */
        video::-webkit-media-controls-panel { display: none !important; -webkit-appearance: none; }
        video::-webkit-media-controls-play-button { display: none !important; -webkit-appearance: none; }
        video::-webkit-media-controls-timeline { display: none !important; -webkit-appearance: none; }
        video::-webkit-media-controls-current-time-display { display: none !important; -webkit-appearance: none; }
        video::-webkit-media-controls-time-remaining-display { display: none !important; -webkit-appearance: none; }
        video::-webkit-media-controls-mute-button { display: none !important; -webkit-appearance: none; }
        video::-webkit-media-controls-volume-slider { display: none !important; -webkit-appearance: none; }
        video::-webkit-media-controls-fullscreen-button { display: none !important; -webkit-appearance: none; }

    </style>
</head>
<body>

    <div class="video-container">
        <video id="myVideo" preload="auto" playsinline> {/* Aggiunto playsinline, rimosso controls */}
            <source src="videos/video1.mp4" type="video/mp4">
            Il tuo browser non supporta il tag video.
        </video>
        <div class="overlay-play-button" id="overlayPlayButton1">
            <i class="fas fa-play"></i>
        </div>
        <div class="custom-controls" id="customControls1">
            <button id="playPauseBtn1"><i class="fas fa-play"></i></button>
            <div class="volume-container">
                <button id="muteBtn1"><i class="fas fa-volume-up"></i></button>
                <input type="range" id="volumeSlider1" class="volume-slider" min="0" max="1" step="0.01" value="1">
            </div>
            <div class="time-container" id="timeContainer1">
                <span id="currentTime1">0:00</span> / <span id="duration1">0:00</span>
            </div>
            <div class="progress-bar-container" id="progressBarContainer1">
                 <input type="range" id="progressBar1" class="progress-bar" value="0" min="0" max="100" step="0.1">
            </div>
            <button id="fullscreenBtn1"><i class="fas fa-expand"></i></button>
        </div>
    </div>

    <div class="video-container">
        <video id="myVideo2" preload="auto" playsinline> {/* Aggiunto playsinline, rimosso controls */}
            <source src="videos/video2.mp4" type="video/mp4">
            Il tuo browser non supporta il tag video.
        </video>
        <div class="overlay-play-button" id="overlayPlayButton2">
            <i class="fas fa-play"></i>
        </div>
        <div class="custom-controls" id="customControls2">
            <button id="playPauseBtn2"><i class="fas fa-play"></i></button>
            <div class="volume-container">
                <button id="muteBtn2"><i class="fas fa-volume-up"></i></button>
                <input type="range" id="volumeSlider2" class="volume-slider" min="0" max="1" step="0.01" value="1">
            </div>
            <div class="time-container" id="timeContainer2">
                <span id="currentTime2">0:00</span> / <span id="duration2">0:00</span>
            </div>
             <div class="progress-bar-container" id="progressBarContainer2">
                <input type="range" id="progressBar2" class="progress-bar" value="0" min="0" max="100" step="0.1">
            </div>
            <button id="fullscreenBtn2"><i class="fas fa-expand"></i></button>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        function setupVideoPlayer(videoNum) {
            const video = document.getElementById('myVideo' + videoNum);
            const overlayPlayButton = document.getElementById('overlayPlayButton' + videoNum);
            const playPauseBtn = document.getElementById('playPauseBtn' + videoNum);
            const muteBtn = document.getElementById('muteBtn' + videoNum);
            const volumeSlider = document.getElementById('volumeSlider' + videoNum);
            const progressBar = document.getElementById('progressBar' + videoNum);
            const fullscreenBtn = document.getElementById('fullscreenBtn' + videoNum);
            const currentTimeDisplay = document.getElementById('currentTime' + videoNum);
            const durationDisplay = document.getElementById('duration' + videoNum);
            const customControls = document.getElementById('customControls' + videoNum);
            const videoContainer = video.parentElement;
            // Elementi da nascondere in fullscreen (usati per riferimento, il CSS fa il lavoro)
            // const timeContainer = document.getElementById('timeContainer' + videoNum); 
            // const progressBarContainer = document.getElementById('progressBarContainer' + videoNum);


            if (!video) { // Controllo per sicurezza
                console.error('Video element not found for videoNum:', videoNum);
                return;
            }
            
            video.controls = false; // Assicura che i controlli nativi siano disabilitati

            function attemptPlay() {
                video.play().then(() => {
                    overlayPlayButton.style.display = 'none';
                    // playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>'; // Gestito da 'play' event
                    // customControls.classList.add('visible'); // Gestito da 'play' event
                }).catch(error => {
                    console.warn("Riproduzione automatica bloccata o errore per video " + videoNum + ":", error.name, error.message);
                    overlayPlayButton.style.display = 'flex';
                    playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                    customControls.classList.add('visible'); // Mostra controlli se play fallisce ma c'è interazione
                });
            }

            overlayPlayButton.addEventListener('click', attemptPlay);
            
            video.addEventListener('click', (e) => {
                // Evita che il click sul video attivi se si clicca sui controlli (propagazione)
                if (e.target === video) { // Solo se il target è il video stesso
                    if (video.paused || video.ended) {
                        attemptPlay();
                    } else {
                        video.pause();
                    }
                }
            });

            playPauseBtn.addEventListener('click', () => {
                if (video.paused || video.ended) {
                    attemptPlay();
                } else {
                    video.pause();
                }
            });

            video.addEventListener('play', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                overlayPlayButton.style.display = 'none';
                customControls.classList.add('visible'); 
                // Nascondi i controlli dopo un po' se il mouse non è sopra e non è touch
                if (!isTouchDevice()) { // Non nascondere automaticamente su touch, gestito da touchend
                    clearTimeout(window['controlsTimeout' + videoNum]);
                     window['controlsTimeout' + videoNum] = setTimeout(() => {
                        if (!video.paused && !videoContainer.matches(':hover')) {
                             customControls.classList.remove('visible');
                        }
                    }, 3000);
                }
            });

            video.addEventListener('pause', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                customControls.classList.add('visible'); // Mantieni visibili i controlli in pausa
                clearTimeout(window['controlsTimeout' + videoNum]); // Cancella timeout se si mette in pausa
            });
             video.addEventListener('ended', () => {
                playPauseBtn.innerHTML = '<i class="fas fa-redo"></i>'; // Icona Replay
                customControls.classList.add('visible');
                overlayPlayButton.style.display = 'flex'; // Mostra overlay per replay facile
                overlayPlayButton.innerHTML = '<i class="fas fa-redo"></i>';
            });


            muteBtn.addEventListener('click', () => {
                video.muted = !video.muted;
                // L'evento 'volumechange' gestirà l'aggiornamento dell'UI
            });

            volumeSlider.addEventListener('input', () => {
                video.volume = parseFloat(volumeSlider.value);
                video.muted = parseFloat(volumeSlider.value) === 0;
                // L'evento 'volumechange' gestirà l'aggiornamento dell'UI
            });
            
            video.addEventListener('volumechange', () => {
                if (video.muted || video.volume === 0) {
                    muteBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
                    volumeSlider.value = video.muted ? 0 : video.volume; // Se mutato, slider a 0
                } else {
                    muteBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
                    volumeSlider.value = video.volume;
                }
            });


            video.addEventListener('loadedmetadata', () => {
                durationDisplay.textContent = formatTime(video.duration);
                progressBar.max = video.duration; // Ora la progress bar va da 0 a video.duration
                progressBar.value = video.currentTime;
                
                // Impostazioni iniziali volume/mute
                volumeSlider.value = video.volume;
                 if (video.muted || video.volume === 0) {
                    muteBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
                    if (video.volume === 0) volumeSlider.value = 0;
                } else {
                    muteBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
                }
                // Mostra i controlli se il video è pronto e non in autoplay (es. se `preload="metadata"`)
                if(video.paused) customControls.classList.add('visible');
            });

            video.addEventListener('timeupdate', () => {
                if (!isNaN(video.duration)) {
                    progressBar.value = video.currentTime;
                    currentTimeDisplay.textContent = formatTime(video.currentTime);
                }
            });

            progressBar.addEventListener('input', () => {
                 if (!isNaN(video.duration)) {
                    video.currentTime = parseFloat(progressBar.value);
                }
            });
            
            fullscreenBtn.addEventListener('click', toggleFullScreen);
            video.addEventListener('dblclick', (e) => {
                 if (e.target === video) toggleFullScreen(); // Solo su video, non controlli
            });

            function toggleFullScreen() {
                const isVideoInFullScreen = !!(document.fullscreenElement === videoContainer || document.webkitFullscreenElement === videoContainer);

                if (!isVideoInFullScreen) {
                    if (videoContainer.requestFullscreen) {
                        videoContainer.requestFullscreen();
                    } else if (videoContainer.webkitRequestFullscreen) { /* Safari */
                        videoContainer.webkitRequestFullscreen();
                    } else if (video.webkitEnterFullscreen) { /* iOS Video Element specific - fallback */
                         video.webkitEnterFullscreen(); 
                    } else if (videoContainer.mozRequestFullScreen) { /* Firefox */
                        videoContainer.mozRequestFullScreen();
                    } else if (videoContainer.msRequestFullscreen) { /* IE11 */
                        videoContainer.msRequestFullscreen();
                    }
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    } else if (document.webkitExitFullscreen) { /* Safari */
                        document.webkitExitFullscreen();
                    } else if (document.mozCancelFullScreen) { /* Firefox */
                        document.mozCancelFullScreen();
                    } else if (document.msExitFullscreen) { /* IE11 */
                        document.msExitFullscreen();
                    }
                }
            }
            
            function handleFullscreenUiChange() {
                const isOurVideoContainerInFullScreen = (document.fullscreenElement === videoContainer || document.webkitFullscreenElement === videoContainer);

                if (isOurVideoContainerInFullScreen) {
                    fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
                    customControls.classList.add('visible'); 
                } else {
                    fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                    if (video.paused) {
                        customControls.classList.add('visible');
                    } else if (!isTouchDevice() && !videoContainer.matches(':hover')) {
                        // Se usciamo da fullscreen e il mouse non è sopra, nascondi i controlli (desktop)
                        customControls.classList.remove('visible');
                    }
                }
            }

            document.addEventListener('fullscreenchange', handleFullscreenUiChange);
            document.addEventListener('webkitfullscreenchange', handleFullscreenUiChange); // Safari, iOS
            document.addEventListener('mozfullscreenchange', handleFullscreenUiChange);    // Firefox
            document.addEventListener('MSFullscreenChange', handleFullscreenUiChange);     // IE11

            // Eventi specifici iOS per fullscreen del video element (non del container)
            video.addEventListener('webkitbeginfullscreen', () => {
                fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
                customControls.classList.add('visible'); // Tenta di mantenere visibili
            });
            video.addEventListener('webkitendfullscreen', () => {
                fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                if (video.paused) customControls.classList.add('visible');
            });


            // Gestione visibilità controlli (mouse)
            window['controlsTimeout' + videoNum] = null; // Timeout per nascondere controlli
            videoContainer.addEventListener('mouseenter', () => {
                if (!video.paused) { // Solo se il video sta suonando
                    customControls.classList.add('visible');
                    clearTimeout(window['controlsTimeout' + videoNum]);
                } else {
                     customControls.classList.add('visible'); // Sempre visibili se in pausa
                }
            });
            videoContainer.addEventListener('mousemove', () => { // Per risvegliare se il mouse si muove
                if (!video.paused) {
                    customControls.classList.add('visible');
                    clearTimeout(window['controlsTimeout' + videoNum]);
                     window['controlsTimeout' + videoNum] = setTimeout(() => {
                        if (!video.paused && !videoContainer.matches(':hover') && !isElementInFullscreen(videoContainer)) {
                            // Non nascondere se in fullscreen e il mouse esce dal video ma non dallo schermo
                           // O se il focus è su un elemento dei controlli
                           if(document.fullscreenElement !== videoContainer) {
                                customControls.classList.remove('visible');
                           }
                        }
                    }, 3000);
                } else {
                     customControls.classList.add('visible');
                }
            });
            videoContainer.addEventListener('mouseleave', () => {
                if (!video.paused && document.fullscreenElement !== videoContainer) { // Non nascondere se in fullscreen
                    clearTimeout(window['controlsTimeout' + videoNum]);
                    window['controlsTimeout' + videoNum] = setTimeout(() => {
                         customControls.classList.remove('visible');
                    }, 500); // Breve ritardo per permettere di spostarsi sui controlli
                }
            });
            
            // Gestione visibilità controlli (touch)
            window['touchControlsTimeout' + videoNum] = null;
            videoContainer.addEventListener('touchstart', (e) => {
                if (e.target === video || e.target === overlayPlayButton || e.target === videoContainer) {
                    if (customControls.classList.contains('visible')) {
                        // Se visibili e video in play, e non si tocca un controllo, nascondi subito (o dopo poco)
                        if (!video.paused && !isDescendant(customControls, e.target)) {
                             //customControls.classList.remove('visible'); // Nasconde al secondo tocco
                             // Oppure resetta il timer per nasconderli
                             clearTimeout(window['touchControlsTimeout' + videoNum]);
                             window['touchControlsTimeout' + videoNum] = setTimeout(() => {
                                if (!video.paused) customControls.classList.remove('visible');
                             }, 3500);
                        }
                    } else { 
                        customControls.classList.add('visible');
                        if (!video.paused) { 
                            clearTimeout(window['touchControlsTimeout' + videoNum]);
                            window['touchControlsTimeout' + videoNum] = setTimeout(() => {
                                customControls.classList.remove('visible');
                            }, 3500);
                        }
                    }
                }
            }, { passive: true }); // passive:true per performance scroll

            customControls.addEventListener('touchstart', (e) => { // Per evitare che il tocco sui controlli li nasconda
                 e.stopPropagation(); // Impedisce al tocco di propagarsi al videoContainer
                 clearTimeout(window['touchControlsTimeout' + videoNum]); // Non nascondere se si interagisce con i controlli
            }, { passive: true });
        }
        
        // Helper functions (globali o dentro DOMContentLoaded)
        function formatTime(timeInSeconds) {
            const result = new Date(Math.max(0, timeInSeconds) * 1000).toISOString().substr(14, 5);
            return result;
        }
        function isTouchDevice() {
            return ('ontouchstart' in window) || (navigator.maxTouchPoints > 0) || (navigator.msMaxTouchPoints > 0);
        }
        function isElementInFullscreen(el) {
            return (document.fullscreenElement === el || document.webkitFullscreenElement === el || document.mozFullScreenElement === el || document.msFullscreenElement === el);
        }
        function isDescendant(parent, child) {
             let node = child.parentNode;
             while (node != null) {
                 if (node == parent) return true;
                 node = node.parentNode;
             }
             return false;
        }


        // Setup per i video
        setupVideoPlayer(''); // Per myVideo, playPauseBtn, ecc.
        setupVideoPlayer('2'); // Per myVideo2, playPauseBtn2, ecc.
    });
    </script>

</body>
</html>
